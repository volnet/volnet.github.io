敏捷数据科学
==========================

![](contents/wx-cover-235-1.png)

用Hadoop创建数据分析应用

作者：[美]Russel Jurney

译者：冯文中 朱洪波

前言
--------------------------

本书的源代码是在*nix系统上面生成的，可以在[https://github.com/rjurney/Agile_Data_code](https://github.com/rjurney/Agile_Data_code)找到。

第1部分 起步
--------------------------

这部分主要是把一些基础的概念、工作流进行介绍。

第1章 理论
--------------------------

以下几项变化能够让我们回归敏捷：

- 通才高于专才
- 小团队高于大团队
- 使用高阶工具和平台：云计算、分布式、PaaS等
- 持续、迭代地分享工作成果，即使这些工作尚未完成

### 敏捷大数据流程

传统的软件产品（特指面向CRUD数据库的应用），数据相对一致，确定性强。

数据挖掘的软件产品：需求会变、数据会变、数据很脏、数据有自己的逻辑，人对于数据的见解只是一种假设，可能是错的，所以即便做了demo，也无法完全避免数据产品不会做偏，而敏捷的方法，是先将最确定的特性先实现，再添加其他特性，让项目更有可能满足产品进化过程中最真实、最根本的需求。在数据产品中，最根本的特性会给人惊喜。假如不是这样，要么是你做错了,要么是你的数据没有太大意义。信息有它的背景，如果背景易变，就无法使用洞察进行预测。

敏捷还需要结对编程等可以互相检查的机制，开放的交流空间和专注的私人空间，还有可以展示过程的白板和海报。

第2章 数据
--------------------------

关系型数据库，将数据拆解到不同的表中，整个过程其实是反直觉的，也要求我们事先对数据的逻辑进行严格地定义。

与SQL相反，创建分析应用时，我们并不知道要查询什么。对于任意问题，都可能需要多次实验和迭代才能得到解决。数据经常难以以关系型格式存在。原始的数据没有标准化，含混不清并充满噪音。为了不同的产品特性处理数据，从数据中抽取结构，是一个长期的迭代过程。

总结一下，当数据模式定义严谨，且SQL是唯一的工具时，我们就不会从挖掘数据的角度看待数据，因为视角会被优化过的数据处理工具所支配。严谨的数据格式抑制了我们在数据与直觉之间建立起联系的能力。另一方面，半结构化的数据可以让我们专注于数据本身，通过迭代地操作数据来抽取价值，并转化为产品。在敏捷大数据中选择NoSQL，是因为它让我们具备了上述能力。

第3章 敏捷开发工具
--------------------------

在选择工具时，我们寻求线性可扩展性。但归根结底，寻求的是简洁。

- 使用Avro对时间进行序列化。
- 使用Pig处理数据：Pig是大数据的传送带。我们用Pig来定义Hadoop中的数据流，这样可以将数据以一种结构化、连贯的方式通过选定的语言及工具进行处理。
- 使用MongoDB发布数据。Pig和MongoDB可以很好地协同工作，而不需要重新定义一遍针对MongoDB的数据格式。
- 使用ElasticSearch搜索数据。
- 使用Wonderdog整合ElasticSearch和Pig。
- 轻量级的Web应用：将已发布的数据转化成一个可以交互的应用。
    - 使用Python和Flask可视化数据
    - 使用d3.js和nvd3.js可视化数据

第4章 在云端
--------------------------

除了在本地完成数据工作，更可以利用云服务商提供的云端工具，来实现，这样可以保证足够大数据运行的基础设施。

- GitHub：用来管理代码
- dotCloud：它本身基于Amazon Web Services，抽象出可靠Web服务以及数据托管的复杂性，并仍能访问其他Amazon Web Services。
- Amazon Web Services：
    - S3（Simple Storage Service），一个基于云服务的Hadoop代替品。
    - EMR（Elastic MapReduce），允许我们启动任意规模的Hadoop集群。
    - MongoDB即服务
- 辅助工具（Instrumentation）
    - Google Analytics：提供了分析网页流量的基本功能。
    - Mortar Data：加速Pig开发的工具。

利用这些云服务商提供的工具可以在云端完成数据挖掘工作。

第2部分 登上金字塔
--------------------------

这部分会沿着“数据-价值金字塔”的顺序，从下往上，逐层讲解。

数据-价值金字塔

|   |    层    |                   关键点                   |                             作用                             |
|---|:--------:|:------------------------------------------:|:------------------------------------------------------------:|
| 5 | 行动     | 驱动，价值，影响，更改，变化，交付         | 指引用户行为去创造和获取价值                                 |
| 4 | 预测     | 整理，推荐，理解，推断，学习               | 使用金字塔结构进行推断、预测和推荐                           |
| 3 | 报表     | 结构，链接，元数据，标签，探索，交互，分享 | 从数据中提取关系和趋势，让我们能创建互动式图表来进行数据探索 |
| 2 | 图表     | 清洗，聚合，可视化，问题                   | 从数据记录中提取出数据的不同属性进行汇总，并将它们绘制成图表 |
| 1 | 数据记录 | 收集，展示，披露单条数据记录               | 整个栈中对原子数据记录的处理和展示                           |

图II-1. Jurney-Warden 作于2011年的数据-价值金字塔（[金字塔图片下载（英文版）](contents/ags2_02.png)）

使用这个金字塔的原则：

1. 上层会依赖下层，不能跳过其中的某一层。
2. 不能提早实现特性，这样会得到一个无法真正揭示现实的产品，必须尊重数据，承认数据有自己的立场。

第5章 收集和展示数据
--------------------------

- 将最原始的数据（这里是邮件）用Web的形式展示出来：在标准的数据流水线中展示原子数据。这是我们的基础。无论最后提供了多么高级的分析结果，用户都会希望看到用于分析的信号本身，也就是支撑结论的原始数据。假如不能正确的把每条原子数据可视化，那么我们的平台和分析策略就会缺乏基础，没有说服力。这一步是不能省略的。
- 发布数据给用户：让用户参与到产品研发的过程中，并提供及时的反馈，同时暴露出部署平台时的一系列问题。
- 为模型建立视图（一个可以用Web展示的界面），并将它共享给整个团队，是建立共识的第一步，否则可能大家理解的数据都不一样。

在将原子数据展示到Web部分后，数据-价值金字塔的第一层就搭建完成了。

第6章 使用图表可视化数据
--------------------------

图表会将数据的各个属性映射到某种视觉表达形式上，以帮助我们理解数据中的实体和概念，形成对数据的第一印象。在这一步，我们的目标是：

1. 发布激发用户兴趣的数据图表，让用户与图表进行交互；
2. 创建能复用的工具，让我们可以在报表中交互地探索数据；
3. 提取数据的结构和实体信息，基于这种结构开发新的特性，得到新的见解。

优秀的图表：用户觉得有趣、值得可视化，并会作出反应的图表，才是好的图表。应该尝试用直觉和好奇心来组织图表。那些促进用户交互行为，得到用户点击的图表是好的图表。

本书将所有的邮件以：邮件地址（含收件人、发件人、转发、抄送）提取所有的值，邮件时间进行统计，并用Web List和Chart的方式展示。

引入了“阅读邮件数量最多的小时”，并在柱状图中高亮，来增加与用户互动的可能性，以引导“该小时是邮件发送给该用户最大概率被看到的时间段”的结论。

第7章 利用报表探索数据
--------------------------

利用报表探索数据，图表会具有交互性，静态页面会变成动态页面。通过在图表中展示网络链接、实体关系，数据也变得更易于探索。

这里一共主要分成几步：

1. 使用多个图表构建数据报表。
    - 设计一个针对一个邮件地址的页面，展示其邮件列表、时间段统计、关联邮件地址等信息。
2. 为数据添加联系。
    - 利用TF-IDF算法，提取邮件中的关键词（高频词），并展示出来。

展示图表的底层展示方式就是不断实现`key=>{property1, property2, links=>[key1, key2, key3]}`，然后将其展现出来。

第8章 预测
--------------------------

第9章 驱动行动
--------------------------